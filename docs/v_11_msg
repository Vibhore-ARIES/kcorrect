Hi all,

A few days ago, Ivan Baldry pointed out an error in the K-correction
code I have been distributing. The absolute magnitudes produced by
using kcorrect v1_10 or earlier are NOT AB magnitudes for the shifted
bandpasses (for a shift redshift of z not equal to 0). The effect of
this error is an overall shift in the absolute magnitudes calculated
by kcorrect; it does not introduce errors as a function of redshift
and it does not introduce errors in the determined color. My
recommendation is that people rerun their code using kcorrect
v1_11. For LSS users, sample9 uses v1_10; I have created a sample10
which uses v1_11, but is in all other ways identical to sample9.

The error affects absolute magnitudes which are calculated in shifted
bandpasses. For example, all absolute magnitudes calculated in the
^{0.1}{ugriz} bandpasses were off by a constant offset equal to 2.5
log_10 (1.1) (independent of the redshift of the galaxy). In general,
any bandpass shifted to z_0 yielded absolute magnitudes off by 2.5
log_10 (1+z_0). Again, these errors affect all colors the same, so
that the colors are correct, and they are not a function of the
redshift of the galaxy, so that any conclusions about evolution are
correct.  However, it is important to get this issue right in order to
recover absolute luminosities.

As an example, take a galaxy at z=0.1 observed in the b-band. Its
K-correction to the ^{0.1}b band is not zero but equal to K(z) = -2.5
log_10 (1+0.1). kcorrect v1_10 and earlier would have incorrectly set
this equal to zero, as part of an overall offset applied to galaxies
at all redshifts (NOT as a function of redshift).

The error exists for kcorrect v1_10 and earlier. A corrected version,
kcorrect v1_11, has been released and is available at:

http://physics.nyu.edu/~mb144/kcorrect

Two other changes have been implemented in the usage of kcorrect:

  1. The IDL "kcorrect" command returns a K-correction now, rather than
     a reconstructed magnitude. The previous behavior (but using the
     correct AB normalization) can be recovered with the /returnmag flag.

  2. The C-code reconstruct_maggies now has two options, at_z and band_z.
     To calculate K-corrections to the bands shifted to 0.1 for a galaxy at
     0.2, you would reconstruct the observed magnitude with at_z=0.2 and
     band_z=0., and the fixed frame magnitude with at_z=0. and band_z=0.1.
     This is explained more fully on the web page.

I apologize for these changes in kcorrect usage, but I feel that in
the long run, it is better to have the code do the sensible thing,
even at the cost of some growing pains early on.

My request and advice is that if you are doing scientific projects
with kcorrect, that you rerun your code using kcorrect v1_11, just to
be safe.  However, if this is prohibitive, you may use kcorrect v1_10
and correct all of your outputs by adding 2.5 log_10 (1+z_0) to all
magnitudes calculated in bandpasses shifted to z_0. This will be
especially easy for anybody who has been K-correcting to z_0=0. (none
of your results will change at all). IF YOU DO THIS, PLEASE STATE THIS
EXPLICITLY IN ANY SCIENTIFIC PUBLICATION, WHEREEVER YOU CITE THE
KCORRECTION METHOD, THAT YOU CORRECTED YOUR OUTPUTS FOR THIS. For
example, you might state:
  
  We calculated the K-corrections $K(z)$ for each galaxy using the
  routines in {\tt kcorrect v1\_10} (Blanton et al. 2002). Version
  {\tt v1\_10} of {\tt kcorrect} did not output AB magnitudes for
  bandpasses shifted to $z_0$ (this error has been corrected for
  later versions). Where necessary we corrected the absolute magnitudes
  in this paper by adding $2.5 \log_{10} (1+z_0)$ to all magnitudes 
  in order to put them on the AB system.

Finally, please note that sample9 of the LSS sample used v1_10 for its
K-corrections. I have built a new sample10, which is identical to
sample9 except with this problem fixed for all outputs. Note that in
addition a small bug in the "photoinfo" files produced for the
subsamples has been fixed. The same rules apply as for rerunning
kcorrect. I would rather that your code was rerun on sample10 rather
than on sample9; in fact, this is probably the easiest option for all
users. However, if this is prohibitive, simply add 2.5 log_10 (1+z_0)
to all absolute magnitudes (note that the safe/full/bright set of
samples is all based on z_0=0.1 magnitudes, so that those magnitudes
need 2.5 log_10 (1.1) added). AS ABOVE, STATE THIS EXPLICITLY IN THE
PAPER. You can use similar wording as above.

Apologies for propagating this error. As stated above, it is good that
the error only creates an overall offset in the absolute magnitude
rather than affecting the colors or the relative magnitudes of
galaxies.

Special thanks go to Ivan Baldry for finding this error, and to David
Hogg and Daniel Eisenstein for helping to work out the corrections
necessary.

Thanks,

Mike Blanton

